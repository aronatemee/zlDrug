{"ReportId":"05710ce6-5923-d622-798e-e28110c195f0","RptParameter":"{\"S_JSSJ\":{\"ID\":\"S_JSSJ\",\"Used\":false,\"Name\":\"结束时间\",\"Type\":3,\"DisplayModel\":0,\"DefaultValue\":\"本月末时间\",\"RptPar\":false,\"Config\":null,\"IsHide\":false},\"S_KSSJ\":{\"ID\":\"S_KSSJ\",\"Used\":false,\"Name\":\"开始时间\",\"Type\":3,\"DisplayModel\":0,\"DefaultValue\":\"本月初时间\",\"RptPar\":false,\"Config\":null,\"IsHide\":false},\"S_DQY\":{\"ID\":\"S_DQY\",\"Used\":true,\"Name\":\"当前页\",\"Type\":2,\"DisplayModel\":0,\"DefaultValue\":\"1\",\"RptPar\":false,\"Config\":null,\"IsHide\":false},\"S_ZYS\":{\"ID\":\"S_ZYS\",\"Used\":true,\"Name\":\"总页数\",\"Type\":2,\"DisplayModel\":0,\"DefaultValue\":\"1\",\"RptPar\":false,\"Config\":null,\"IsHide\":false},\"S_CZY\":{\"ID\":\"S_CZY\",\"Used\":false,\"Name\":\"操作员\",\"Type\":1,\"DisplayModel\":0,\"DefaultValue\":\"\",\"RptPar\":false,\"Config\":null,\"IsHide\":false},\"S_CZYBM\":{\"ID\":\"S_CZYBM\",\"Used\":false,\"Name\":\"操作员编码\",\"Type\":1,\"DisplayModel\":0,\"DefaultValue\":\"\",\"RptPar\":false,\"Config\":null,\"IsHide\":false},\"CS\":{\"Order\":1,\"ID\":\"CS\",\"Used\":true,\"Name\":\"参数\",\"Type\":1,\"DisplayModel\":0,\"DefaultValue\":\"[{\\\"Rcp_No\\\":\\\"23003060900\\\",\\\"Pati_Id\\\":\\\"2831272\\\",\\\"Storehouse_Id\\\":\\\"74\\\",\\\"Order_Id\\\":\\\"3315021\\\",\\\"Pati_Name\\\":\\\"蔡晓燕\\\",\\\"Pati_Bed\\\":\\\"35\\\",\\\"Inpatient_Num\\\":\\\"438718\\\",\\\"Pati_Page_Id\\\":\\\"1\\\"}]\",\"Format\":\"clob\",\"RptPar\":true,\"Config\":null,\"IsHide\":false,\"IsDataSetPar\":false}}","RptDataset":"[{\"ID\":\"199f9c81-d496-40ae-eed9-1d7797a69542\",\"Name\":\"bb\",\"UsedParametersId\":\"[\\\"CS\\\"]\",\"UsedExpressionID\":\"[]\",\"Configuration\":{\"AgentPars\":[{\"Name\":\"CS\",\"ParValue\":\"{P_CS}\",\"Format\":\"clob\",\"ParDirection\":1,\"ParType\":1}],\"DSEnum\":0,\"CmdTimeOut\":999,\"SQL\":\"--更改之后的 新·药袋\\n/* \\n药袋，使用SQL来编写：\\n时点对照表已完成，\\n\\n打印药袋规则：\\n1. 固定早上只出今日长嘱、临嘱药袋；下午出今天及明天长嘱药袋、今天临嘱药袋。（需使用最新版本药品系统进行测试）\\n2. 长嘱必定有药袋，临嘱只有执行次数 <= 单日执行频次的才打印药袋。\\n\\n换页标识规则：\\n1. 每 5 种药 + 1 行汇总，换页。\\n2. 同名时点合并，不同时点换页。\\n3. 若有嘱托，该药单独计算药袋。\\n4. 若药品规格中的使用说明字段有值，则单独计算。（此处一般是标识0-8度药品需单独保存）（未完成）\\n5. 药品名称中含有“咀嚼”、“泡腾”的，需要单独计算药袋。（完成）\\n\\n每个药袋只能有五种药，那么就需要先用row_number列出同病人、同日、同时点的药品行号，然后用 行号 / 5 来换页！\\n\\n别忘了顺序要和摆药单一致。\\n\\n床号有可能含有非数字：cast(regexp_replace(出院病床, '[^0-9]', '') as numeric)\\n\\n*/\\nselect * from (\\nselect * from (\\n--计算实际换页标识。\\nselect zz.科室, zz.床号, zz.住院号, zz.姓名, zz.护士实际一次发送哪几天 as 真_服药日期, zz.服药时间, zz.医嘱, zz.规格, zz.用法, zz.执行频次, zz.频率次数, zz.用量, zz.医生嘱托, zz.床号0, zz.病人id, zz.首次, zz.嘱托换页, zz.咀嚼泡腾换页\\n, zz.病人id || '/' || to_char(zz.日期, 'yyyy-mm-dd') || '/' || zz.匹配 || '/' || zz.嘱托换页 || '/' || zz.咀嚼泡腾换页 ||  '/' || zz.护士实际一次发送哪几天 ||  '/' || trunc(zz.该药袋第几种药 / 6) as 换页标识, zz.药品id\\n, zz.匹配 from (\\n--计算原本药袋有多少种药。\\nselect ww.科室, ww.床号, ww.住院号, ww.姓名, ww.服药日期, ww.服药时间, ww.医嘱, ww.规格, ww.用法, ww.执行频次, ww.频率次数, ww.用量, ww.医生嘱托, ww.床号0, ww.病人id, ww.首次\\n, ww.药品id, case when ww.医生嘱托 is not null then ww.医生嘱托 else '' end as 嘱托换页, case when ww.医嘱 like '%咀嚼%' then '咀嚼' when ww.医嘱 like '%泡腾%' then '泡腾' else '通常' end as 咀嚼泡腾换页\\n, ww.日期, ww.匹配, row_number() over(partition by ww.床号0, ww.病人id, to_char(ww.日期, 'yyyy-mm-dd'), case when ww.医生嘱托 is not null then ww.药品id || ww.医生嘱托 else '' end, ww.匹配\\n order by ww.床号0 asc, ww.病人id asc, to_char(ww.日期, 'yyyy-mm-dd') asc, case when ww.医生嘱托 is not null then ww.药品id || ww.医生嘱托 else '' end, ww.匹配 desc, ww.药品id asc) as 该药袋第几种药, ww.护士实际一次发送哪几天 \\n from (\\n--★★★长嘱必定打印药袋★★★\\nselect * from (\\nselect \\n  RPAD('科室: ' || temp_origin_continuous.科室, 30, ' ') as 科室, '床号: ' || temp_origin_continuous.床号 || ' 床' as 床号\\n  , RPAD('住院号: ' || temp_origin_continuous.住院号, 30, ' ') AS 住院号, '姓名: ' || temp_origin_continuous.姓名 as 姓名\\n  , RPAD('服药日期: ' || to_char(temp_origin_continuous.日期, 'yyyy-mm-dd'), 30, ' ') as 服药日期, '服药时间: ' || drugbag_rec.时点 as 服药时间\\n  , temp_origin_continuous.医嘱, temp_origin_continuous.规格, temp_origin_continuous.用法, temp_origin_continuous.执行频次, temp_origin_continuous.频率次数\\n  , temp_origin_continuous.用量, temp_origin_continuous.医生嘱托\\n  , cast(regexp_replace(temp_origin_continuous.床号, '[^0-9]', '') as numeric) as 床号0, temp_origin_continuous.病人id, temp_origin_continuous.日期, drugbag_rec.匹配, drugbag_rec.首次, temp_origin_continuous.药品id\\n  , temp_origin_continuous.开始执行时间, RPAD('服药日期: ' || temp_origin_continuous.护士实际一次发送哪几天, 30, ' ')  as 护士实际一次发送哪几天\\nfrom (\\n--源数据集（转科后，e.出院病床 是最新的床号，而 e.入院病床 是原来的\\nselect distinct i.规格, a.库房id, a.药品id, a.医嘱id, e.出院病床 as 床号, e.病人id, e.主页id, NVL(h.名称, g.名称) as 医嘱\\n  , RTRIM(to_char(b.单次用量/d.剂量系数,'fm990.99999'), '.')||d.住院单位 as 用量,a.用法\\n  , c.首次时间 as 日期, b.执行频次, b.频率次数, b.首日数次, f.名称 as 科室, b.姓名||decode(b.婴儿,0,'','【婴】') as 姓名, a.年龄, e.住院号, b.医生嘱托, b.开始执行时间\\n  , datesplit.要求日期 as 护士实际一次发送哪几天\\n  from 药品收发记录 a,病人医嘱记录 b ,药品规格 d,病案主页 e,部门表 f,病人医嘱发送 c,病人医嘱发送 c2, 收费项目目录 g, 收费项目别名 h, 药品目录 i\\n  , (select distinct to_char(yzzxsj.要求时间, 'yyyy-mm-dd') as 要求日期, yzzxsj.医嘱id, yzzxsj.发送号 \\nfrom 医嘱执行时间 yzzxsj\\nwhere (yzzxsj.医嘱id, yzzxsj.发送号) in (\\nselect a.id as 给药途径医嘱id, b.发送号 as 给药途径发送号 \\nfrom 病人医嘱记录 a \\njoin 病人医嘱发送 b on a.id = b.医嘱id\\nwhere (a.id, b.发送时间) in (\\nselect 给药途径医嘱id, 药品发送时间 from \\n(\\nselect a.id as 药品医嘱id, a.相关id as 给药途径医嘱id, b.发送号 as 药品医嘱发送号, b.发送时间 as 药品发送时间 \\nfrom 病人医嘱记录 a\\njoin 病人医嘱发送 b on a.id = b.医嘱id\\nwhere (b.no, b.医嘱id) in  \\n(select no, Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n)\\n)\\n)) datesplit\\n  where  a.医嘱id=b.id\\n  and a.药品id=d.药品id\\n  and a.病人id=e.病人id\\n  and a.主页id=e.主页id\\n  and a.对方部门id=f.id\\n  and b.id=c.医嘱id\\n  and b.相关id = c2.医嘱id\\n  and  a.no=c.no\\n  and a.药品id = g.id\\n  and g.id = h.收费细目id(+)\\n  and a.药品id = i.药品id\\n  and h.性质(+) = 3\\n  and datesplit.医嘱id = b.相关id and c2.发送号 = datesplit.发送号\\n  \\n  -- 长嘱\\n  and b.医嘱期效 = 0\\n  and a.填制日期 > to_date('20230518223500', 'yyyy-mm-dd hh24:mi:ss')\\n  \\n/*  -- 没有嘱托\\n  and (b.医生嘱托 is null or b.医生嘱托 = '')*/\\n  \\n  --执行性质 = 5，表现为离院带药等。由于本sql是服务于药袋，故不需要离院带药的部分。\\n  and b.执行性质 <> 5\\n  \\n  --药品收发记录中，(Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) 意味着原始记录。\\n  and   (Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) \\n  \\n  --只有口服需要打印药袋\\n  AND A.用法 IN ('口服(发热门诊专用)','口服','冲水服','口服研粉','含服','泡服','胃管注入','鼻饲','气管内滴药','开水冲服','煎服')\\n  \\n  --AND A.汇总发药号 IS NOT NULL\\n  and (a.no, a.病人id, a.库房id, a.医嘱id) in\\n (select no, pid, Storehouse_id, Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n) temp_origin_continuous \\n--药袋时点表\\njoin drugbag_rec on temp_origin_continuous.执行频次 = drugbag_rec.执行频率\\n--当前no的首次执行时间 = 首日 && 首日数次匹配（医生填了首日数次才会有值）。\\nwhere (temp_origin_continuous.护士实际一次发送哪几天 = to_char(temp_origin_continuous.开始执行时间, 'yyyy-mm-dd') and drugbag_rec.首次 <= temp_origin_continuous.首日数次 and temp_origin_continuous.首日数次 is not null)\\n--当前no的首次执行时间 = 首日 && 医生没有填写首日数次\\nor (temp_origin_continuous.护士实际一次发送哪几天 = to_char(temp_origin_continuous.开始执行时间, 'yyyy-mm-dd') and temp_origin_continuous.首日数次 is null)\\n--当前no首次执行时间 ！= 首日，匹配全部次数。\\nor (temp_origin_continuous.护士实际一次发送哪几天 <> to_char(temp_origin_continuous.开始执行时间, 'yyyy-mm-dd'))\\norder by temp_origin_continuous.床号 asc, temp_origin_continuous.病人id asc, temp_origin_continuous.日期 asc, drugbag_rec.匹配 desc, temp_origin_continuous.药品id\\n\\n) abc\\n\\n\\nunion all\\n\\nselect * from (\\n--★★★临嘱一天内需打印药袋★★★\\n--注意，临嘱没有首日数次这个字段。\\nselect \\n  RPAD('科室: ' || temp_origin_temporary.科室, 30, ' ') as 科室, '床号: ' || temp_origin_temporary.床号 || ' 床' as 床号\\n  , RPAD('住院号: ' || temp_origin_temporary.住院号, 30, ' ') AS 住院号, '姓名: ' || temp_origin_temporary.姓名 as 姓名\\n  , RPAD('服药日期: ' || to_char(temp_origin_temporary.日期, 'yyyy-mm-dd'), 30, ' ') as 服药日期, '服药时间: ' || drugbag_rec.时点 as 服药时间\\n  , temp_origin_temporary.医嘱, temp_origin_temporary.规格, temp_origin_temporary.用法, temp_origin_temporary.执行频次, temp_origin_temporary.频率次数\\n  , temp_origin_temporary.用量, temp_origin_temporary.医生嘱托\\n  , cast(regexp_replace(temp_origin_temporary.床号, '[^0-9]', '') as numeric) as 床号0, temp_origin_temporary.病人id, temp_origin_temporary.日期, drugbag_rec.匹配, drugbag_rec.首次, temp_origin_temporary.药品id\\n  , temp_origin_temporary.开始执行时间, RPAD('服药日期: ' || to_char(temp_origin_temporary.日期, 'yyyy-mm-dd'), 30, ' ') as 护士实际一次发送哪几天\\nfrom (\\n--源数据集\\nselect distinct i.规格, a.库房id, a.药品id, a.医嘱id, e.出院病床 as 床号, e.病人id, e.主页id, NVL(h.名称, g.名称) as 医嘱\\n  , RTRIM(to_char(b.单次用量/d.剂量系数,'fm990.99999'), '.')||d.住院单位 as 用量,a.用法\\n  , c.首次时间 as 日期, b.执行频次, b.频率次数, b.首日数次, f.名称 as 科室, b.姓名||decode(b.婴儿,0,'','【婴】') as 姓名, a.年龄, e.住院号, b.医生嘱托, b.开始执行时间\\n  from 药品收发记录 a,病人医嘱记录 b ,药品规格 d,病案主页 e,部门表 f,病人医嘱发送 c, 收费项目目录 g, 收费项目别名 h, 药品目录 i, 医嘱执行时间 j\\n  , (\\n  SELECT Y.医嘱ID, COUNT(Y.医嘱ID) AS 临嘱执行次数 \\n  FROM 医嘱执行时间 Y\\n  JOIN 病人医嘱记录 B ON Y.医嘱ID = B.相关ID\\n  WHERE B.ID IN (select Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n  GROUP BY Y.医嘱ID\\n  ) YY\\n  where  a.医嘱id=b.id\\n  and a.药品id=d.药品id\\n  and a.病人id=e.病人id\\n  and a.主页id=e.主页id\\n  and a.对方部门id=f.id\\n  and b.id=c.医嘱id\\n  and  a.no=c.no\\n  and a.药品id = g.id\\n  and g.id = h.收费细目id(+)\\n  and a.药品id = i.药品id\\n  and b.相关id = j.医嘱id\\n  and b.相关id = yy.医嘱ID\\n  and h.性质(+) = 3\\n  \\n  \\n  -- 临嘱\\n  and b.医嘱期效 = 1\\n  and a.填制日期 > to_date('20230518223500', 'yyyy-mm-dd hh24:mi:ss')\\n  \\n/*  -- 没有嘱托\\n  and (b.医生嘱托 is null or b.医生嘱托 = '')*/\\n  \\n  --执行性质 = 5，表现为离院带药等。由于本sql是服务于药袋，故不需要离院带药的部分。\\n  and b.执行性质 <> 5\\n  \\n  --药品收发记录中，(Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) 意味着原始记录。\\n  and   (Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) \\n  \\n  --只有口服需要打印药袋\\n  AND A.用法 IN ('口服(发热门诊专用)','口服','冲水服','口服研粉','含服','泡服','胃管注入','鼻饲','气管内滴药','开水冲服','煎服')\\n  \\n  --按照执行次数\\n  AND YY.临嘱执行次数 <= CASE b.执行频次\\n  WHEN '每天四次' THEN 4\\n  WHEN '每天三次' THEN 3\\n  WHEN '每天二次' THEN 2 \\n  WHEN '一次性' THEN 1 \\n  WHEN '每天一次' THEN 1 \\n  WHEN '每天早晨一次' THEN 1\\n  WHEN '每天上午一次' THEN 1\\n  WHEN '每天早晨一次' THEN 1\\n  WHEN '每天晚上一次' THEN 1\\n  WHEN '每4小时一次' THEN 6\\n  WHEN '每6小时一次' THEN 4\\n  WHEN '每8小时一次' THEN 3\\n  WHEN '每12小时一次' THEN 2\\n  WHEN '需要时' THEN 1\\n  ELSE 0 END\\n  \\n  --AND A.汇总发药号 IS NOT NULL\\n  and (a.no, a.病人id, a.库房id, a.医嘱id) in\\n (select no, pid, Storehouse_id, Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n) temp_origin_temporary \\n--药袋时点表\\nleft join drugbag_rec on temp_origin_temporary.执行频次 = drugbag_rec.执行频率\\norder by temp_origin_temporary.床号 asc, temp_origin_temporary.病人id asc, temp_origin_temporary.日期 asc, drugbag_rec.匹配 desc, temp_origin_temporary.药品id\\n) def\\n) ww\\norder by ww.床号0 asc, ww.病人id asc, to_char(ww.日期, 'yyyy-mm-dd') asc, case when ww.医生嘱托 is not null then ww.药品id || ww.医生嘱托 else '' end, ww.匹配 desc, ww.药品id asc\\n) zz\\norder by zz.床号0 asc, zz.病人id asc, to_char(zz.日期, 'yyyy-mm-dd') asc, zz.嘱托换页, zz.咀嚼泡腾换页, zz.匹配 desc, zz.药品id asc\\n) xxx\\n\\n\\n\\nunion all \\n\\n\\n/* 每袋合计多少粒？ */\\nselect yyy.科室, yyy.床号, yyy.住院号, yyy.姓名, yyy.真_服药日期, yyy.服药时间, null as 医嘱, null as 规格, '本袋共 ' || sum(yyy.用量0) || ' 粒' as 用法, null as 执行频次, null as 频率次数\\n, null as 用量, null as 医生嘱托, yyy.床号0, yyy.病人id, null as 首次, yyy.嘱托换页, yyy.咀嚼泡腾换页, yyy.换页标识, 9999999 as 药品id\\n, yyy.匹配 from (\\n--计算实际换页标识。\\nselect zz.科室, zz.床号, zz.住院号, zz.姓名, zz.护士实际一次发送哪几天 as 真_服药日期, zz.服药时间, zz.医嘱, zz.规格, zz.用法, zz.执行频次, zz.频率次数, zz.用量0, zz.用量, zz.医生嘱托, zz.床号0, zz.病人id, zz.首次, zz.嘱托换页, zz.咀嚼泡腾换页\\n, zz.病人id || '/' || to_char(zz.日期, 'yyyy-mm-dd') || '/' || zz.匹配 || '/' || zz.嘱托换页 || '/' || zz.咀嚼泡腾换页 || '/' || zz.护士实际一次发送哪几天 ||  '/' || trunc(zz.该药袋第几种药 / 6) as 换页标识, zz.药品id\\n, zz.匹配 from (\\n--计算原本药袋有多少种药。\\nselect ww.科室, ww.床号, ww.住院号, ww.姓名, ww.服药日期, ww.服药时间, ww.医嘱, ww.规格, ww.用法, ww.执行频次, ww.频率次数, ww.用量, ww.医生嘱托, ww.床号0, ww.病人id, ww.首次\\n, ww.药品id, ww.用量0, case when ww.医生嘱托 is not null then ww.医生嘱托 else '' end as 嘱托换页, case when ww.医嘱 like '%咀嚼%' then '咀嚼' when ww.医嘱 like '%泡腾%' then '泡腾' else '通常' end as 咀嚼泡腾换页\\n, ww.日期, ww.匹配, row_number() over(partition by ww.床号0, ww.病人id, to_char(ww.日期, 'yyyy-mm-dd'), case when ww.医生嘱托 is not null then ww.药品id || ww.医生嘱托 else '' end, ww.匹配\\n order by ww.床号0 asc, ww.病人id asc, to_char(ww.日期, 'yyyy-mm-dd') asc, case when ww.医生嘱托 is not null then ww.药品id || ww.医生嘱托 else '' end, ww.匹配 desc, ww.药品id asc) as 该药袋第几种药, ww.护士实际一次发送哪几天 \\n from (\\n--★★★长嘱必定打印药袋★★★\\nselect * from (\\nselect \\n  RPAD('科室: ' || temp_origin_continuous.科室, 30, ' ') as 科室, '床号: ' || temp_origin_continuous.床号 || ' 床' as 床号\\n  , RPAD('住院号: ' || temp_origin_continuous.住院号, 30, ' ') AS 住院号, '姓名: ' || temp_origin_continuous.姓名 as 姓名\\n  , RPAD('服药日期: ' || to_char(temp_origin_continuous.日期, 'yyyy-mm-dd'), 30, ' ') as 服药日期, '服药时间: ' || drugbag_rec.时点 as 服药时间\\n  , temp_origin_continuous.医嘱, temp_origin_continuous.规格, temp_origin_continuous.用法, temp_origin_continuous.执行频次, temp_origin_continuous.频率次数\\n  , temp_origin_continuous.用量0, temp_origin_continuous.用量, temp_origin_continuous.医生嘱托\\n  , cast(regexp_replace(temp_origin_continuous.床号, '[^0-9]', '') as numeric) as 床号0, temp_origin_continuous.病人id, temp_origin_continuous.日期, drugbag_rec.匹配, drugbag_rec.首次, temp_origin_continuous.药品id\\n  , temp_origin_continuous.开始执行时间, RPAD('服药日期: ' || temp_origin_continuous.护士实际一次发送哪几天, 30, ' ') as 护士实际一次发送哪几天\\nfrom (\\n--源数据集\\nselect distinct i.规格, a.库房id, a.药品id, a.医嘱id, e.出院病床 as 床号, e.病人id, e.主页id, NVL(h.名称, g.名称) as 医嘱\\n  , RTRIM(to_char(b.单次用量/d.剂量系数,'fm990.99999'), '.') as 用量0, RTRIM(to_char(b.单次用量/d.剂量系数,'fm990.99999'), '.')||d.住院单位 as 用量,a.用法\\n  , c.首次时间 as 日期, b.执行频次, b.频率次数, b.首日数次, f.名称 as 科室, b.姓名||decode(b.婴儿,0,'','【婴】') as 姓名, a.年龄, e.住院号, b.医生嘱托, b.开始执行时间\\n  , datesplit.要求日期 as 护士实际一次发送哪几天\\n  from 药品收发记录 a,病人医嘱记录 b ,药品规格 d,病案主页 e,部门表 f,病人医嘱发送 c,病人医嘱发送 c2, 收费项目目录 g, 收费项目别名 h, 药品目录 i\\n  , (select distinct to_char(yzzxsj.要求时间, 'yyyy-mm-dd') as 要求日期, yzzxsj.医嘱id, yzzxsj.发送号 \\nfrom 医嘱执行时间 yzzxsj\\nwhere (yzzxsj.医嘱id, yzzxsj.发送号) in (\\nselect a.id as 给药途径医嘱id, b.发送号 as 给药途径发送号 \\nfrom 病人医嘱记录 a \\njoin 病人医嘱发送 b on a.id = b.医嘱id\\nwhere (a.id, b.发送时间) in (\\nselect 给药途径医嘱id, 药品发送时间 from \\n(\\nselect a.id as 药品医嘱id, a.相关id as 给药途径医嘱id, b.发送号 as 药品医嘱发送号, b.发送时间 as 药品发送时间 \\nfrom 病人医嘱记录 a\\njoin 病人医嘱发送 b on a.id = b.医嘱id\\nwhere (b.no, b.医嘱id) in  \\n(select no, Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n)\\n)\\n)) datesplit\\n  where  a.医嘱id=b.id\\n  and a.药品id=d.药品id\\n  and a.病人id=e.病人id\\n  and a.主页id=e.主页id\\n  and a.对方部门id=f.id\\n  and b.id=c.医嘱id\\n  and b.相关id = c2.医嘱id\\n  and  a.no=c.no\\n  and a.药品id = g.id\\n  and g.id = h.收费细目id(+)\\n  and a.药品id = i.药品id\\n  and h.性质(+) = 3\\n  and datesplit.医嘱id = b.相关id and c2.发送号 = datesplit.发送号\\n  \\n  -- 长嘱\\n  and b.医嘱期效 = 0\\n  and a.填制日期 > to_date('20230518223500', 'yyyy-mm-dd hh24:mi:ss')\\n  \\n  \\n/*  -- 没有嘱托\\n  and (b.医生嘱托 is null or b.医生嘱托 = '')*/\\n  \\n  --执行性质 = 5，表现为离院带药等。由于本sql是服务于药袋，故不需要离院带药的部分。\\n  and b.执行性质 <> 5\\n  \\n  --药品收发记录中，(Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) 意味着原始记录。\\n  and   (Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) \\n  \\n  --只有口服需要打印药袋\\n  AND A.用法 IN ('口服(发热门诊专用)','口服','冲水服','口服研粉','含服','泡服','胃管注入','鼻饲','气管内滴药','开水冲服','煎服')\\n  \\n  --AND A.汇总发药号 IS NOT NULL\\n  and (a.no, a.病人id, a.库房id, a.医嘱id) in\\n (select no, pid, Storehouse_id, Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n) temp_origin_continuous \\n--药袋时点表\\njoin drugbag_rec on temp_origin_continuous.执行频次 = drugbag_rec.执行频率\\n--当前no的首次执行时间 = 首日 && 首日数次匹配（医生填了首日数次才会有值）。\\nwhere (temp_origin_continuous.护士实际一次发送哪几天 = to_char(temp_origin_continuous.开始执行时间, 'yyyy-mm-dd') and drugbag_rec.首次 <= temp_origin_continuous.首日数次 and temp_origin_continuous.首日数次 is not null)\\n--当前no的首次执行时间 = 首日 && 医生没有填写首日数次\\nor (temp_origin_continuous.护士实际一次发送哪几天 = to_char(temp_origin_continuous.开始执行时间, 'yyyy-mm-dd') and temp_origin_continuous.首日数次 is null)\\n--当前no首次执行时间 ！= 首日，匹配全部次数。\\nor (temp_origin_continuous.护士实际一次发送哪几天 <> to_char(temp_origin_continuous.开始执行时间, 'yyyy-mm-dd'))\\norder by temp_origin_continuous.床号 asc, temp_origin_continuous.病人id asc, temp_origin_continuous.日期 asc, drugbag_rec.匹配 desc, temp_origin_continuous.药品id\\n\\n) abc\\n\\nunion all\\n\\nselect * from (\\n--★★★临嘱一天内需打印药袋★★★\\n--注意，临嘱没有首日数次这个字段。\\nselect \\n  RPAD('科室: ' || temp_origin_temporary.科室, 30, ' ') as 科室, '床号: ' || temp_origin_temporary.床号 || ' 床' as 床号\\n  , RPAD('住院号: ' || temp_origin_temporary.住院号, 30, ' ') AS 住院号, '姓名: ' || temp_origin_temporary.姓名 as 姓名\\n  , RPAD('服药日期: ' || to_char(temp_origin_temporary.日期, 'yyyy-mm-dd'), 30, ' ') as 服药日期, '服药时间: ' || drugbag_rec.时点 as 服药时间\\n  , temp_origin_temporary.医嘱, temp_origin_temporary.规格, temp_origin_temporary.用法, temp_origin_temporary.执行频次, temp_origin_temporary.频率次数\\n  , temp_origin_temporary.用量0, temp_origin_temporary.用量, temp_origin_temporary.医生嘱托\\n  , cast(regexp_replace(temp_origin_temporary.床号, '[^0-9]', '') as numeric) as 床号0, temp_origin_temporary.病人id, temp_origin_temporary.日期, drugbag_rec.匹配, drugbag_rec.首次, temp_origin_temporary.药品id\\n  , temp_origin_temporary.开始执行时间, RPAD('服药日期: ' || to_char(temp_origin_temporary.日期, 'yyyy-mm-dd'), 30, ' ') as 护士实际一次发送哪几天\\nfrom (\\n--源数据集\\nselect distinct i.规格, a.库房id, a.药品id, a.医嘱id, e.出院病床 as 床号, e.病人id, e.主页id, NVL(h.名称, g.名称) as 医嘱\\n  , RTRIM(to_char(b.单次用量/d.剂量系数,'fm990.99999'), '.') as 用量0, RTRIM(to_char(b.单次用量/d.剂量系数,'fm990.99999'), '.')||d.住院单位 as 用量,a.用法\\n  , c.首次时间 as 日期, b.执行频次, b.频率次数, b.首日数次, f.名称 as 科室, b.姓名||decode(b.婴儿,0,'','【婴】') as 姓名, a.年龄, e.住院号, b.医生嘱托, b.开始执行时间\\n  from 药品收发记录 a,病人医嘱记录 b ,药品规格 d,病案主页 e,部门表 f,病人医嘱发送 c, 收费项目目录 g, 收费项目别名 h, 药品目录 i, 医嘱执行时间 j\\n  , (\\n  SELECT Y.医嘱ID, COUNT(Y.医嘱ID) AS 临嘱执行次数 \\n  FROM 医嘱执行时间 Y\\n  JOIN 病人医嘱记录 B ON Y.医嘱ID = B.相关ID\\n  WHERE B.ID IN (select Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n  GROUP BY Y.医嘱ID\\n  ) YY\\n  where  a.医嘱id=b.id\\n  and a.药品id=d.药品id\\n  and a.病人id=e.病人id\\n  and a.主页id=e.主页id\\n  and a.对方部门id=f.id\\n  and b.id=c.医嘱id\\n  and  a.no=c.no\\n  and a.药品id = g.id\\n  and g.id = h.收费细目id(+)\\n  and a.药品id = i.药品id\\n  and b.相关id = j.医嘱id\\n  and b.相关id = yy.医嘱ID\\n  and h.性质(+) = 3\\n  \\n  \\n  -- 临嘱\\n  and b.医嘱期效 = 1\\n  and a.填制日期 > to_date('20230518223500', 'yyyy-mm-dd hh24:mi:ss')\\n  \\n  \\n/*  -- 没有嘱托\\n  and (b.医生嘱托 is null or b.医生嘱托 = '')*/\\n  \\n  --执行性质 = 5，表现为离院带药等。由于本sql是服务于药袋，故不需要离院带药的部分。\\n  and b.执行性质 <> 5\\n  \\n  --药品收发记录中，(Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) 意味着原始记录。\\n  and   (Mod(A.记录状态, 3) = 0 Or A.记录状态 = 1) \\n  \\n  --只有口服需要打印药袋\\n  AND A.用法 IN ('口服(发热门诊专用)','口服','冲水服','口服研粉','含服','泡服','胃管注入','鼻饲','气管内滴药','开水冲服','煎服')\\n  \\n  --按照执行次数\\n  AND YY.临嘱执行次数 <= CASE b.执行频次\\n  WHEN '每天四次' THEN 4\\n  WHEN '每天三次' THEN 3\\n  WHEN '每天二次' THEN 2 \\n  WHEN '一次性' THEN 1 \\n  WHEN '每天一次' THEN 1 \\n  WHEN '每天早晨一次' THEN 1\\n  WHEN '每天上午一次' THEN 1\\n  WHEN '每天早晨一次' THEN 1\\n  WHEN '每天晚上一次' THEN 1\\n  WHEN '每4小时一次' THEN 6\\n  WHEN '每6小时一次' THEN 4\\n  WHEN '每8小时一次' THEN 3\\n  WHEN '每12小时一次' THEN 2\\n  WHEN '需要时' THEN 1\\n  ELSE 0 END\\n  \\n  --AND A.汇总发药号 IS NOT NULL\\n  and (a.no, a.病人id, a.库房id, a.医嘱id) in\\n (select no, pid, Storehouse_id, Order_Id from\\n  json_table(:CS,'$'columns (nested path '$[*]' columns(no varchar2(20) path '$.Rcp_No', pid number path '$.Pati_Id', Storehouse_Id number path '$.Storehouse_Id',Order_Id number path '$.Order_Id'))) )\\n) temp_origin_temporary \\n--药袋时点表\\nleft join drugbag_rec on temp_origin_temporary.执行频次 = drugbag_rec.执行频率\\norder by temp_origin_temporary.床号 asc, temp_origin_temporary.病人id asc, temp_origin_temporary.日期 asc, drugbag_rec.匹配 desc, temp_origin_temporary.药品id\\n) def\\n) ww\\norder by ww.床号0 asc, ww.病人id asc, to_char(ww.日期, 'yyyy-mm-dd') asc, case when ww.医生嘱托 is not null then ww.药品id || ww.医生嘱托 else '' end, ww.匹配 desc, ww.药品id asc\\n) zz\\norder by zz.床号0 asc, zz.病人id asc, to_char(zz.日期, 'yyyy-mm-dd') asc, zz.嘱托换页, zz.咀嚼泡腾换页, zz.匹配 desc, zz.药品id asc\\n) yyy\\ngroup by yyy.科室, yyy.床号, yyy.住院号, yyy.姓名, yyy.真_服药日期, yyy.服药时间, yyy.床号0, yyy.病人id, yyy.真_服药日期, yyy.嘱托换页, yyy.咀嚼泡腾换页, yyy.匹配, yyy.换页标识\\n) zzzz\\nwhere zzzz.医嘱 not like '%肠内营养液%'\\nor zzzz.医嘱 is null\\norder by zzzz.床号0 asc, zzzz.病人id asc, zzzz.真_服药日期 asc, zzzz.嘱托换页, zzzz.咀嚼泡腾换页, zzzz.匹配 desc, zzzz.换页标识, zzzz.药品id asc\\n\",\"MaxRowCount\":-1},\"DataFields\":[{\"ColumnName\":\"科室\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"床号\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"住院号\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"姓名\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"真_服药日期\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"服药时间\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"医嘱\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"规格\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"用法\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"执行频次\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"频率次数\",\"BizType\":2,\"Children\":[]},{\"ColumnName\":\"用量\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"医生嘱托\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"床号0\",\"BizType\":2,\"Children\":[]},{\"ColumnName\":\"病人ID\",\"BizType\":2,\"Children\":[]},{\"ColumnName\":\"首次\",\"BizType\":2,\"Children\":[]},{\"ColumnName\":\"嘱托换页\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"咀嚼泡腾换页\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"换页标识\",\"BizType\":1,\"Children\":[]},{\"ColumnName\":\"药品ID\",\"BizType\":2,\"Children\":[]},{\"ColumnName\":\"匹配\",\"BizType\":2,\"Children\":[]}],\"DsId\":\"8fdc81fc-8626-4b57-9de0-291196e07a20\",\"IsCommon\":false,\"IsLocalDataSet\":false,\"DsType\":0}]","RptContent":"{\"LayoutInfo\":\"{\\\"LayoutName\\\":\\\"Layout1\\\",\\\"PageSzie\\\":{\\\"pageName\\\":\\\"自定义大小\\\",\\\"PageType\\\":256,\\\"Width\\\":9000,\\\"Height\\\":10000,\\\"IsLandScape\\\":true,\\\"AutoHight\\\":false,\\\"ValChangePage\\\":true,\\\"LastPageAutoHight\\\":false,\\\"PrintModel\\\":0,\\\"ViewModel\\\":0},\\\"Watermark\\\":{\\\"Content\\\":{\\\"DisplayText\\\":\\\"\\\",\\\"Content\\\":\\\"\\\"},\\\"Font\\\":\\\"宋体, 8pt\\\",\\\"RotateAngle\\\":-15,\\\"ForeColor\\\":\\\"rgb(255, 255, 255)\\\",\\\"Transparency\\\":\\\"100\\\"},\\\"Items\\\":[{\\\"Name\\\":\\\"表格1\\\",\\\"RptItemType\\\":1,\\\"TabIndex\\\":1,\\\"Location\\\":\\\"14, 54\\\",\\\"Size\\\":\\\"357, 264\\\",\\\"IsLocking\\\":false,\\\"ForeColor\\\":\\\"rgb(255, 255, 255)\\\",\\\"Selected\\\":false,\\\"ReferenceItem\\\":\\\"\\\",\\\"IsCrossTable\\\":false,\\\"RowNumber\\\":3,\\\"ColNumber\\\":3,\\\"FillColor\\\":\\\"rgb(253, 253, 253)\\\",\\\"LineHeight\\\":26,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\",\\\"SubTables\\\":[],\\\"IsPrintEmptyTable\\\":false,\\\"IsFillEmptyRow\\\":false,\\\"MultiColumn\\\":1,\\\"MultiColumnDirection\\\":0,\\\"TableFieldInfos\\\":[{\\\"ID\\\":\\\"153ced97-b26d-6eba-0138-349b596b80b1\\\",\\\"TableName\\\":null,\\\"FieldColumnName\\\":null,\\\"Index\\\":0,\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":1,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Width\\\":12,\\\"FieldStringFormat\\\":\\\"\\\",\\\"NoZero\\\":false,\\\"ConditionExpID\\\":\\\"\\\",\\\"ConditionStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"ConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"GatherType\\\":0,\\\"FieldHeaderInfos\\\":[{\\\"ID\\\":\\\"3e738868-5714-b8c4-a6d0-073c76503124\\\",\\\"LabelValueInfo\\\":{\\\"DisplayText\\\":\\\"表达式\\\",\\\"Content\\\":\\\"表达式\\\"},\\\"AllowMerger\\\":false,\\\"MyCellStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"rgb(253, 253, 253)\\\",\\\"textAlignEnum\\\":4,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Height\\\":22,\\\"Index\\\":0}],\\\"FiledType\\\":1,\\\"Value\\\":\\\"return bb.科室 + bb.床号 + \\\\\\\"                           \\\\\\\" + bb.住院号 + bb.姓名 \\\\n + \\\\\\\"                           \\\\\\\" + bb.真_服药日期 + bb.服药时间\\\",\\\"ExpId\\\":\\\"1d8b8b17-8a39-326d-21d5-ec8075eb2cfe\\\",\\\"ReferenceMerge\\\":\\\"\\\",\\\"IsHiden\\\":true,\\\"ContentShowModel\\\":\\\"1\\\",\\\"CustomNewLine\\\":true,\\\"IsAutoTurnPage\\\":false,\\\"IsGroup\\\":true,\\\"IsShowGroupBorder\\\":true,\\\"IsAutoCalGroupLineHeight\\\":false,\\\"GroupLineHeight\\\":45,\\\"GroupStringFormat\\\":\\\"{0}\\\",\\\"GroupConditionExp\\\":\\\"\\\",\\\"GroupModal\\\":0,\\\"GroupStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"GroupConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"IsServerImageCol\\\":false,\\\"ContinueModal\\\":\\\"0\\\",\\\"WhiteSpaceNoContinue\\\":false,\\\"SortModal\\\":0,\\\"ImageCol\\\":false,\\\"ImageSize\\\":\\\"-1|-1\\\",\\\"UrlContent\\\":null,\\\"HidenType\\\":\\\"0\\\"},{\\\"ID\\\":\\\"57f9c845-f140-6727-337d-f43e3753d29c\\\",\\\"TableName\\\":\\\"bb\\\",\\\"FieldColumnName\\\":\\\"医嘱\\\",\\\"Index\\\":1,\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":1,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 11pt, style=Bold\\\"},\\\"Width\\\":169,\\\"FieldStringFormat\\\":\\\"\\\",\\\"NoZero\\\":false,\\\"ConditionExpID\\\":\\\"\\\",\\\"ConditionStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"ConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"GatherType\\\":0,\\\"FieldHeaderInfos\\\":[{\\\"ID\\\":\\\"fc6cc648-053f-28f5-2e17-444e0aba3c55\\\",\\\"LabelValueInfo\\\":{\\\"DisplayText\\\":\\\"药品名/规格\\\",\\\"Content\\\":\\\"药品名/规格\\\"},\\\"AllowMerger\\\":false,\\\"MyCellStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"rgb(253, 253, 253)\\\",\\\"textAlignEnum\\\":5,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Height\\\":22,\\\"Index\\\":0}],\\\"FiledType\\\":0,\\\"Value\\\":\\\"[bb.医嘱]\\\",\\\"ExpId\\\":null,\\\"ReferenceMerge\\\":\\\"\\\",\\\"IsHiden\\\":false,\\\"ContentShowModel\\\":\\\"1\\\",\\\"CustomNewLine\\\":false,\\\"IsAutoTurnPage\\\":false,\\\"IsGroup\\\":false,\\\"IsShowGroupBorder\\\":false,\\\"IsAutoCalGroupLineHeight\\\":false,\\\"GroupLineHeight\\\":36,\\\"GroupStringFormat\\\":\\\"{0}\\\",\\\"GroupConditionExp\\\":\\\"\\\",\\\"GroupModal\\\":0,\\\"GroupStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"GroupConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"IsServerImageCol\\\":false,\\\"ContinueModal\\\":\\\"0\\\",\\\"WhiteSpaceNoContinue\\\":false,\\\"SortModal\\\":0,\\\"ImageCol\\\":false,\\\"ImageSize\\\":\\\"-1|-1\\\",\\\"UrlContent\\\":null,\\\"HidenType\\\":0},{\\\"ID\\\":\\\"83cd34eb-ca55-9271-e5b7-332d0d671b57\\\",\\\"TableName\\\":\\\"bb\\\",\\\"FieldColumnName\\\":\\\"用量\\\",\\\"Index\\\":2,\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":4,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Width\\\":41.1007,\\\"FieldStringFormat\\\":\\\"\\\",\\\"NoZero\\\":false,\\\"ConditionExpID\\\":\\\"\\\",\\\"ConditionStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"ConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"GatherType\\\":0,\\\"FieldHeaderInfos\\\":[{\\\"ID\\\":\\\"97618fc2-7a0d-3fda-c24a-6e3a3b012f6c\\\",\\\"LabelValueInfo\\\":{\\\"DisplayText\\\":\\\"用量\\\",\\\"Content\\\":\\\"用量\\\"},\\\"AllowMerger\\\":false,\\\"MyCellStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"rgb(253, 253, 253)\\\",\\\"textAlignEnum\\\":5,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Height\\\":22,\\\"Index\\\":0}],\\\"FiledType\\\":0,\\\"Value\\\":\\\"[bb.用量]\\\",\\\"ExpId\\\":null,\\\"ReferenceMerge\\\":\\\"\\\",\\\"IsHiden\\\":false,\\\"ContentShowModel\\\":\\\"1\\\",\\\"CustomNewLine\\\":false,\\\"IsAutoTurnPage\\\":false,\\\"IsGroup\\\":false,\\\"IsShowGroupBorder\\\":false,\\\"IsAutoCalGroupLineHeight\\\":false,\\\"GroupLineHeight\\\":36,\\\"GroupStringFormat\\\":\\\"{0}\\\",\\\"GroupConditionExp\\\":\\\"\\\",\\\"GroupModal\\\":0,\\\"GroupStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"GroupConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"IsServerImageCol\\\":false,\\\"ContinueModal\\\":\\\"0\\\",\\\"WhiteSpaceNoContinue\\\":false,\\\"SortModal\\\":0,\\\"ImageCol\\\":false,\\\"ImageSize\\\":\\\"-1|-1\\\",\\\"UrlContent\\\":null,\\\"HidenType\\\":0},{\\\"ID\\\":\\\"de11fe9a-06a3-a6f0-4368-ff4bd1e7e456\\\",\\\"TableName\\\":null,\\\"FieldColumnName\\\":null,\\\"Index\\\":3,\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":4,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Width\\\":129,\\\"FieldStringFormat\\\":\\\"\\\",\\\"NoZero\\\":false,\\\"ConditionExpID\\\":\\\"\\\",\\\"ConditionStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"ConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"GatherType\\\":0,\\\"FieldHeaderInfos\\\":[{\\\"ID\\\":\\\"0a7d3c23-ce98-d25c-196e-fd7f83bfb8c7\\\",\\\"LabelValueInfo\\\":{\\\"DisplayText\\\":\\\"用法\\\",\\\"Content\\\":\\\"用法\\\"},\\\"AllowMerger\\\":false,\\\"MyCellStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"rgb(253, 253, 253)\\\",\\\"textAlignEnum\\\":5,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Height\\\":21,\\\"Index\\\":0}],\\\"FiledType\\\":1,\\\"Value\\\":\\\"if(bb.医生嘱托 == null || bb.医生嘱托 == \\\\\\\"null\\\\\\\"){\\\\n  return bb.用法;\\\\n} else {\\\\n  return bb.用法 + \\\\\\\", \\\\\\\" + bb.医生嘱托;\\\\n}\\\",\\\"ExpId\\\":\\\"cfca79bd-14d7-997b-0d31-97bb0058fd7a\\\",\\\"ReferenceMerge\\\":\\\"\\\",\\\"IsHiden\\\":false,\\\"ContentShowModel\\\":\\\"1\\\",\\\"CustomNewLine\\\":false,\\\"IsAutoTurnPage\\\":false,\\\"IsGroup\\\":false,\\\"IsShowGroupBorder\\\":false,\\\"IsAutoCalGroupLineHeight\\\":false,\\\"GroupLineHeight\\\":21,\\\"GroupStringFormat\\\":\\\"{0}\\\",\\\"GroupConditionExp\\\":\\\"\\\",\\\"GroupModal\\\":0,\\\"GroupStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"GroupConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"IsServerImageCol\\\":false,\\\"ContinueModal\\\":\\\"0\\\",\\\"WhiteSpaceNoContinue\\\":false,\\\"SortModal\\\":0,\\\"ImageCol\\\":false,\\\"ImageSize\\\":\\\"-1|-1\\\",\\\"UrlContent\\\":null,\\\"HidenType\\\":\\\"0\\\"},{\\\"ID\\\":\\\"0139fb77-0678-5f39-3a7f-47c2af0a5f0d\\\",\\\"TableName\\\":\\\"bb\\\",\\\"FieldColumnName\\\":\\\"换页标识\\\",\\\"Index\\\":4,\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":4,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Width\\\":10,\\\"FieldStringFormat\\\":\\\"\\\",\\\"NoZero\\\":false,\\\"ConditionExpID\\\":\\\"\\\",\\\"ConditionStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"ConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"GatherType\\\":0,\\\"FieldHeaderInfos\\\":[{\\\"ID\\\":\\\"8be4875a-bdf8-8dbf-b9d0-00126fc3fcb3\\\",\\\"LabelValueInfo\\\":{\\\"DisplayText\\\":\\\"分组标识\\\",\\\"Content\\\":\\\"分组标识\\\"},\\\"AllowMerger\\\":false,\\\"MyCellStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"rgb(253, 253, 253)\\\",\\\"textAlignEnum\\\":4,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 10pt, style=Bold\\\"},\\\"Height\\\":22,\\\"Index\\\":0}],\\\"FiledType\\\":0,\\\"Value\\\":\\\"[bb.换页标识]\\\",\\\"ExpId\\\":null,\\\"ReferenceMerge\\\":\\\"\\\",\\\"IsHiden\\\":true,\\\"ContentShowModel\\\":\\\"1\\\",\\\"CustomNewLine\\\":false,\\\"IsAutoTurnPage\\\":true,\\\"IsGroup\\\":false,\\\"IsShowGroupBorder\\\":false,\\\"IsAutoCalGroupLineHeight\\\":false,\\\"GroupLineHeight\\\":21,\\\"GroupStringFormat\\\":\\\"{0}\\\",\\\"GroupConditionExp\\\":\\\"\\\",\\\"GroupModal\\\":0,\\\"GroupStyle\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"},\\\"GroupConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"ExpId\\\":\\\"\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"IsServerImageCol\\\":false,\\\"ContinueModal\\\":\\\"0\\\",\\\"WhiteSpaceNoContinue\\\":false,\\\"SortModal\\\":0,\\\"ImageCol\\\":false,\\\"ImageSize\\\":\\\"-1|-1\\\",\\\"UrlContent\\\":null,\\\"HidenType\\\":0}],\\\"MergerRanges\\\":[],\\\"ExtendCopyableFields\\\":[\\\"0139fb77-0678-5f39-3a7f-47c2af0a5f0d\\\"],\\\"AutoSplitLastRow\\\":false,\\\"OffsetY\\\":0},{\\\"Name\\\":\\\"标签\\\",\\\"RptItemType\\\":4,\\\"TabIndex\\\":1,\\\"Location\\\":\\\"14, 318\\\",\\\"Size\\\":\\\"160, 22\\\",\\\"IsLocking\\\":false,\\\"ForeColor\\\":\\\"black\\\",\\\"Selected\\\":false,\\\"ReferenceItem\\\":\\\"表格1\\\",\\\"ReferenceType\\\":5,\\\"BackColor\\\":\\\"Transparent\\\",\\\"ColContentAlign\\\":0,\\\"Font\\\":\\\"宋体, 9pt\\\",\\\"LabelValueInfo\\\":{\\\"DisplayText\\\":\\\"[变量-当前页]/[变量-总页数]\\\",\\\"Content\\\":\\\"&[I-S_DQY]/&[I-S_ZYS]\\\"},\\\"LabelValueMode\\\":2,\\\"StatisticsMode\\\":1,\\\"ConditionInfo\\\":{\\\"Name\\\":\\\"样式1\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}},\\\"ConditionInfoList\\\":[{\\\"Name\\\":\\\"样式1\\\",\\\"Style\\\":{\\\"ForeColor\\\":\\\"Black\\\",\\\"BackColor\\\":\\\"White\\\",\\\"textAlignEnum\\\":0,\\\"WordWrap\\\":false,\\\"Font\\\":\\\"宋体, 9pt\\\"}}],\\\"FormatString\\\":\\\"{0}\\\",\\\"AutoFont\\\":false,\\\"AutoSize\\\":false,\\\"IsShowBorder\\\":false,\\\"RotateAngle\\\":0,\\\"ShowOnlyOnce\\\":false,\\\"UrlContent\\\":{\\\"DisplayText\\\":\\\"\\\",\\\"Content\\\":\\\"\\\"}},{\\\"Name\\\":\\\"线条\\\",\\\"RptItemType\\\":3,\\\"TabIndex\\\":1,\\\"Location\\\":\\\"16, 100\\\",\\\"Size\\\":\\\"353, 10\\\",\\\"IsLocking\\\":false,\\\"ForeColor\\\":\\\"black\\\",\\\"Selected\\\":false,\\\"ReferenceItem\\\":\\\"\\\",\\\"LineType\\\":0,\\\"StartPoint\\\":\\\"16, 105\\\",\\\"EndPoint\\\":\\\"369, 105\\\",\\\"DashStyle\\\":0,\\\"Width\\\":2,\\\"Length\\\":353},{\\\"Name\\\":\\\"线条1\\\",\\\"RptItemType\\\":3,\\\"TabIndex\\\":1,\\\"Location\\\":\\\"15, 120\\\",\\\"Size\\\":\\\"354, 10\\\",\\\"IsLocking\\\":false,\\\"ForeColor\\\":\\\"black\\\",\\\"Selected\\\":false,\\\"ReferenceItem\\\":\\\"\\\",\\\"LineType\\\":0,\\\"StartPoint\\\":\\\"15, 125\\\",\\\"EndPoint\\\":\\\"369, 125\\\",\\\"DashStyle\\\":0,\\\"Width\\\":2,\\\"Length\\\":354}]}\",\"ExpressInfo\":\"{\\\"1d8b8b17-8a39-326d-21d5-ec8075eb2cfe\\\":{\\\"Exp_Id\\\":\\\"1d8b8b17-8a39-326d-21d5-ec8075eb2cfe\\\",\\\"Exp_String\\\":\\\"return bb.科室 + bb.床号 + \\\\\\\"                           \\\\\\\" + bb.住院号 + bb.姓名 \\\\n + \\\\\\\"                           \\\\\\\" + bb.真_服药日期 + bb.服药时间\\\"},\\\"cfca79bd-14d7-997b-0d31-97bb0058fd7a\\\":{\\\"Exp_Id\\\":\\\"cfca79bd-14d7-997b-0d31-97bb0058fd7a\\\",\\\"Exp_String\\\":\\\"if(bb.医生嘱托 == null || bb.医生嘱托 == \\\\\\\"null\\\\\\\"){\\\\n  return bb.用法;\\\\n} else {\\\\n  return bb.用法 + \\\\\\\", \\\\\\\" + bb.医生嘱托;\\\\n}\\\"}}\"}"}